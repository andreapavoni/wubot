<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hbot</title>
  <link href="styles.css" rel="stylesheet" type="text/css" />
</head>
<body>

  <div class="centered">
    <h1>Huboard</h1>

    <div class="js-replies" id="replies">
      <p class="message"><span class="name">Hubot:</span> Hello there, I'm here to serve your commands</p>
    </div>

    <div class="command-bar">
      <input class="js-command-input" id="command-input" type="text" autofocus/></input>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io();

    $('#command-input').keydown(function(event) {
      if (event.keyCode == 13) {
        var that = $(this);
        socket.emit('message', that.val());
        that.val('');
      }
    });

    socket.on('message', function(data){
      var replies = $('#replies');
      var message;
      if (data.match(/(jpeg|jpg|gif|png)$/) != null) {
        message = $(("<p class='message'/>"));
        $("<span class='name'>Hubot:</span><br/><img src='" + data + "' widht='400' height='400'>").appendTo(message);
        message.appendTo(replies);
      } else {
        pars = [];
        $.each(data.split("\n"), function( index, value ) {
          $(("<p class='message'><span class='name'>Hubot:</span> " + value + "</p>")).appendTo(replies);
        });
      }

      replies.scrollTop(replies.get(0).scrollHeight);
    });
  </script>

</body>
</html>
